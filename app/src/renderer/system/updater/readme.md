Notes:

When testing in development mode...

## Local Update Server

1. Clone the realm update server

- Nav to the source root folder
- Run `yarn install`

Before running `yarn start`, you will need to ensure that the path to the build files generate by the `npx` command (see later in document) is set. The update server uses this path to resolve requests generated by the electron-updater.

To do this, set the AUTOUPDATE_SERVER_DIR environment variable to the path on disk where the `npx` build output files can be found.

Example combined with `yarn start`: `AUTOUPDATE_SERVER_DIR=/Users/home/realm/app/release/build yarn start`

This will start the update server and read files from the AUTOUPDATE_SERVER_DIR folder

**NOTE:**

- If AUTOUPDATE_SERVER_DIR is not set, the \_\_dirname value is used

## Realm app

1. Ensure the following environment variables are set

- AUTOUPDATE_FEED_URL - the update server url
- AUTOUPDATE_CURRENT_VERSION - the base version used by electron-updater to determine if updates are available

Example command line: `AUTOUPDATE_CURRENT_VERSION=0.1.0 AUTOUPDATE_FEED_URL=http://localhost:3001 yarn start`

**NOTE:**

- `AUTOUPDATE_CURRENT_VERSION` required. used to determine if auto updating should be enabled.
- If `AUTOUPDATE_FEED_URL` is not set, a default value of `http://localhost:3001` is used

2. Ensure the 'next' build version is set

- Open `app/release/app/package.json`
- Set the version string to a version 'later' than the AUTOUPDATE_CURRENT_VERSION set above

For example, if:

AUTOUPDATE_CURRENT_VERSION=0.1.0

in order for electron-updater to pick up the update:

SET the version value in `app/release/app/package.json` to `0.2.0` or later

3. Generate the yml and build artifacts in support of updates

- Clean out the `app/release/build` folder
- Run `npx cross-env yarn package:prerelease:mac`

This will generate the same files as an official Github build.

**Note: The mac binary is not signed and notarized in development**
